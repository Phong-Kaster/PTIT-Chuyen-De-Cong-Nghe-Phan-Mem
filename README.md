<h1 align="center">Chuy√™n ƒê·ªÅ C√¥ng Ngh·ªá Ph·∫ßn M·ªÅm<br/>
    ƒê·ªÅ t√†i: Ch·ª©ng Kho√°n
</h1>

<p align="center">
    <img src="./avatar/horizon-zero-dawn.jpg" width="1280" />
</p>


# [**Table Of Content**](#table-of-content)
- [**Table Of Content**](#table-of-content)
- [**Introduction**](#introduction)
- [**How To Read**](#how-to-read)
  - [**Topic Number 2**](#topic-number-2)
  - [**Topic Number 3**](#topic-number-3)
- [**Post Script**](#post-script)
- [**Timeline**](#timeline)
  - [**07-03-2022**](#07-03-2022)
  - [**08-03-2022**](#08-03-2022)
  - [**09-03-2022**](#09-03-2022)
- [**Made with üíò and PHP <img src="https://www.vectorlogo.zone/logos/php/php-horizontal.svg" width="60">**](#made-with--and-php-)

# [**Introduction**](#introduction)
Ch√†o c√°c b·∫°n, l·∫°i l√† m√¨nh, Phong n√® üòã. Trong ƒë·ªì √°n n√†y m√¨nh s·∫Ω gi·ªõi thi·ªáu c√°c b·∫°n tham kh·∫£o v·ªÅ ƒë·ªì √°n m√¥n Chuy√™n ƒë·ªÅ C√¥ng ngh·ªá ph·∫ßn m·ªÅm do gi·∫£ng vi√™n huy·ªÅn tho·∫°i - L∆∞u Nguy·ªÖn K√¨ Th∆∞ gi·∫£ng d·∫°y.

V·ªõi m√¥n n√†y, m√¨nh ƒë∆∞·ª£c nh·∫≠n ƒë·ªÅ s·ªë 2. Tuy nhi√™n, ƒë·ªÉ tƒÉng th√™m kinh nghi·ªám & tƒÉng ƒë·ªô kh√≥ cho gameüòé. M√¨nh quy·∫øt ƒë·ªãnh l√†m c·∫£ ƒë·ªÅ s·ªë 3, c≈©ng chung c∆° s·ªü d·ªØ li·ªáu v·ªõi ƒë·ªÅ s·ªë 2 lu√¥n ! Kh√¥ng n√≥i nhi·ªÅu n·ªØa .

Los geht's üí•

# [**How To Read**](#how-to-read)

ƒê·ªÉ c√°c b·∫°n d·ªÖ n·∫Øm b·∫Øt & l√†m ƒë·ªì √°n theo nhu c·∫ßu c·ªßa b·∫£n th√¢n th√¨ m√¨nh s·∫Ω vi·∫øt n·ªôi dung ph·ª• thu·ªôc v√†o ƒë·ªÅ t√†i c√°c b·∫°n mu·ªën l√†m nh√©. N·∫øu c√°c b·∫°n l√†m ƒë·ªÅ t√†i s·ªë 3 th√¨ v·∫´n c√≥ th·ªÉ tham kh·∫£o ƒë∆∞·ª£c

## [**Topic Number 2**](#topic-number-2)

Mu·ªën l√†m ƒë·ªÅ t√†i n√†y c√°c b·∫°n c·∫ßn hi·ªÉu Cursor l√† g√¨ ? N·∫øu ch∆∞a bi·∫øt th√¨ v√†o [**ƒë√¢y**](https://youtu.be/8tKf-PqdrAg?t=1466) h·ªçc nh√© ü•±. 
Ti·∫øp theo, ƒë·ªÉ c√≥ th·ªÉ ho√†n thi·ªán ƒë∆∞·ª£c c√°i Stored Procedure th·∫ßy cho nh∆∞ng ch∆∞a ho√†n thi·ªán. C√°c b·∫°n c·∫ßn hi·ªÉu c√°ch thu·∫≠n to√°n n√†y ho·∫°t ƒë·ªông qua v√≠ d·ª• ph√≠a d∆∞·ªõi ƒë√¢y:

Gi·∫£ s·ª≠ ch√∫ng ta c√°c m·ªôt b·∫£ng L·ªánh ƒê·∫∑t nh∆∞ h√¨nh d∆∞·ªõi

| ID | M√£ C·ªï Phi·∫øu | Ng√†y ƒê·∫∑t   | Lo·∫°i Giao D·ªãch | Lo·∫°i L·ªánh | S·ªë L∆∞·ª£ng | Gi√° ƒê·∫∑t |
|----|-------------|------------|----------------|-----------|----------|---------|
| 1  | Panther     | 01-05-2022 | M              | LO        | 1000     | 10000   |
| 2  | Panther     | 01-05-2022 | M              | LO        | 1000     | 10500   |
| 3  | Panther     | 01-05-2022 | M              | LO        | 1500     | 11000   |
| 4  | Panther     | 01-05-2022 | M              | LO        | 1000     | 9500    |
| 5  | Tiger       | 01-05-2022 | B              | LO        | 2700     | 10200   |

Gi·ªù ch√∫ng ta ra m·ªôt l·ªánh B√ÅN c√≥ th√¥ng tin nh∆∞ sau:

| ID | M√£ C·ªï Phi·∫øu | Ng√†y ƒê·∫∑t   | Lo·∫°i Giao D·ªãch | Lo·∫°i L·ªánh | S·ªë L∆∞·ª£ng | Gi√° ƒê·∫∑t |
|----|-------------|------------|----------------|-----------|----------|---------|
| 6  | Panther     | 01-05-2022 | B              | LO        | 2700     | 10200   |

ƒê·ªÉ th·ª±c hi·ªán l·ªánh n√†y th√¨ ch√∫ng ta s·∫Ω d√πng c√¢u SQL nh∆∞ sau

    exec [sp_KhopLenhLienTuc] 'AC', '2022-03-08', 'B', 2700, 12500

Khi ch·∫°y c√¢u l·ªánh n√†y, th√¨ tr√¨nh t·ª± x·ª≠ l√Ω s·∫Ω nh∆∞ sau:

**B∆∞·ªõc 1:** Cursor t√¨m t·∫•t c·∫£ c√°c l·ªánh giao `M` v√¨ giao d·ªãch g·ª≠i t·ªõi l√† `B` v√† tr√¨nh t·ª± s·∫Øp x·∫øp s·∫Ω ∆∞u ti√™n gi√° mua t·ª´ cao t·ªõi th·∫•p, th·ªùi gian t·ª´ m·ªõi t·ªõi c≈©. Ch√∫ng s·∫Ω c√≥ th·ª© t·ª± nh∆∞ b·∫£ng ph√≠a d∆∞·ªõi ƒë√¢y

| ID | M√£ C·ªï Phi·∫øu | Ng√†y ƒê·∫∑t   | Lo·∫°i Giao D·ªãch | Lo·∫°i L·ªánh | S·ªë L∆∞·ª£ng | Gi√° ƒê·∫∑t |
|----|-------------|------------|----------------|-----------|----------|---------|
| 3  | Panther     | 01-05-2022 | M              | LO        | 1000     | 11000   |
| 2  | Panther     | 01-05-2022 | M              | LO        | 1000     | 10500   |
| 1  | Panther     | 01-05-2022 | M              | LO        | 1500     | 10000   |
| 4  | Panther     | 01-05-2022 | M              | LO        | 1000     | 9500    |

**B∆∞·ªõc 2:** Kh·ªõp l·ªánh l·∫ßn l∆∞·ª£t t·ª´ giao d·ªãch `M` c√≥ gi√° mua cao nh√¢t tr∆∞·ªõc v·ªõi gi√° kh·ªõp lu√¥n ∆∞u ti√™n gi√° mua >= gi√° b√°n

Giao d·ªãch `B` c√≥ s·ªë l∆∞·ª£ng l√† *2700* & giao d·ªãch `M` v·ªõi ID = 3 c√≥ s·ªë l∆∞·ª£ng l√† 1000. S·ªë l∆∞·ª£ng c√≤n l·∫°i c·ªßa giao d·ªãch `B` l√† 1700. Gi√° kh·ªõp l√† *11000*

Giao d·ªãch `B` c√≥ s·ªë l∆∞·ª£ng l√† *1700* & giao d·ªãch `M` v·ªõi ID = 2 c√≥ s·ªë l∆∞·ª£ng l√† 1000. S·ªë l∆∞·ª£ng c√≤n l·∫°i c·ªßa giao d·ªãch `B` l√† 700. Gi√° kh·ªõp l√† *10500*

ƒê·∫øn ƒë√¢y, giao d·ªãch n√†y kh√¥ng th·ªÉ ti·∫øp t·ª•c b·ªüi giao d·ªãch `M` v·ªõi ID = 1 c√≥ gi√° mua th·∫•p h∆°n gi√° b√°n c·ªßa `B` n√™n stored procedure n√†y s·∫Ω d·ª´ng l·∫°i.

**B∆∞·ªõc 3:** V·∫≠y sau khi k·∫øt th√∫c phi√™n kh·ªõp l·ªánh th√¨ b·∫£ng L·ªÜNH ƒê·∫∂T ph√≠a tr√™n s·∫Ω c√≥ h√¨nh d·∫°ng nh∆∞ sau:

| ID | M√£ C·ªï Phi·∫øu | Ng√†y ƒê·∫∑t   | Lo·∫°i Giao D·ªãch | Lo·∫°i L·ªánh | S·ªë L∆∞·ª£ng | Gi√° ƒê·∫∑t |
|----|-------------|------------|----------------|-----------|----------|---------|
| 1  | Panther     | 01-05-2022 | M              | LO        | 1000     | 10000   |
| 2  | Panther     | 01-05-2022 | M              | LO        | 0        | 10500   |
| 3  | Panther     | 01-05-2022 | M              | LO        | 0        | 11000   |
| 4  | Panther     | 01-05-2022 | M              | LO        | 1000     | 9500    |
| 5  | Tiger       | 01-05-2022 | B              | LO        | 2700     | 10200   |
| 6  | Panther     | 01-05-2022 | B              | LO        | 700      | 10200   |

Giao d·ªãch `B` v·ªõi ID = 6 s·∫Ω ·ªü trong b·∫£ng n√†y ƒë·ªÉ ch·ªù c√°c l·ªánh `M` kh√°c g·ª≠i t·ªõi v√† kh·ªõp ti·∫øp.

·ªû b·∫£ng L·ªÜNH KH·ªöP, ch√∫ng ta s·∫Ω c√≥ d·ªØ li·ªáu nh∆∞ sau

| ID | Ng√†y Kh·ªõp  | S·ªë L∆∞·ª£ng Kh·ªõp | Gi√° Kh·ªõp | ID L·ªánh ƒê·∫∑t |
|----|------------|---------------|----------|-------------|
| 1  | 01-05-2022 | 1000          | 11000    | 3           |
| 2  | 01-05-2022 | 1000          | 10500    | 2           |

**B∆∞·ªõc 4:** N·∫øu ƒë√£ hi·ªÉu & l√†m xong Stored Procedure v√† thi·∫øt k·∫ø giao di·ªán ƒë∆°n gi·∫£n nh∆∞ d∆∞·ªõi ƒë√¢y l√† coi nh∆∞ b·∫°n ƒë√£ ho√†n thi·ªát ƒë·ªÅ t√†i s·ªë 2 r·ªìi √° !

<p align="center">
    <img src="./avatar/screen1.png" width="1280" />
</p>
<space>

<h2 align="center">

  *Giao di·ªán m√†n h√¨nh giao d·ªãch*
</h2>

## [**Topic Number 3**](#topic-number-3)

ƒê·ªÉ l√†m ƒë·ªÅ t√†i 3, c√°c b·∫°n c·∫ßn t√¨m hi·ªÉu Trigger l√† g√¨ ? Sau ƒë√≥, c·∫ßn hi·ªÉu √Ω nghƒ©a c·ªßa d·ªãch v·ª• SQL Broker trong SQL Server v√† SQL Dependency trong C#. 

N·∫øu ch∆∞a bi·∫øt 2 ƒë·ª©a n√†y l√† g√¨ th√¨ h√£y nh·∫•n v√†o [**ƒë√¢y**](#) ƒë·ªÉ t√¨m hi·ªÉu nha üòã.

V·∫≠y t·∫°i sao ph·∫£i d√πng Trigger ? V√¨ Trigger l√† Stored Procedure ƒë·∫∑c bi·ªát ho·∫°t ƒë·ªông khi c√≥ m·ªôt h√†nh ƒë·ªông n√†o ƒë√≥ x·∫£y ra. ·ªû ƒë·ªÅ t√†i 3, c√°c b·∫°n c√≥ th·ªÉ th·∫•y m·ªói khi ch√∫ng ta l·∫≠p m·ªôt giao d·ªãch mua | b√°n c·ªï phi·∫øu. Th√¨ ngay sau khi l·∫≠p giao d·ªãch xong, b·∫£ng gi√° tr·ª±c tuy·∫øn c·∫ßn ƒë∆∞·ª£c ho·∫°t ƒë·ªông ngay l·∫≠p t·ª©c ƒë·ªÉ hi·ªÉn th·ªã gi√° c·ªï phi·∫øu m·ªõi. V√† Trigger ch√≠nh l√† ch√¨a kh√≥a üîë ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y.

V·∫≠y SQL Broker l√† c√°i chi chi ? N√≥ l√† d·ªãch v·ª• c·ªßa SQL Server, d√πng ƒë·ªÉ theo d√µi c√°c h√†nh ƒë·ªông thay ƒë·ªïi d·ªØ li·ªáu tr√™n m·ªôt b·∫£ng d·ªØ li·ªáu n√†o ƒë√≥. Nh·ªù c√≥ d·ªãch v·ª• n√†y m√† khi l√†m c√≥ m·ªôt thao t√°c x·∫£y ra th√¨ n√≥ s·∫Ω c·∫≠p nh·∫≠t d·ªØ li·ªáu trong Data Grid View ngay l·∫≠p t·ª©c.
Nh∆∞·ª£c ƒëi·ªÉm duy nh·∫•t l√† do c·∫ßn theo d√µi n√™n SQL Broker s·∫Ω li√™n t·ª•c g·ª≠i y√™u c·∫ßu t·ªõi SQL Server, do v·∫≠y n√™n n√≥ s·∫Ω b·ªã ch·∫≠m ƒëi ƒë√¥i ch√∫t.

ƒê·ªÉ l√†m ƒë·ªÅ t√†i n√†y c√°c b·∫°n s·∫Ω c·∫ßn t·∫°o th√™m m·ªôt b·∫£ng gi√° tr·ª±c tuy·∫øn c√≥ h√¨nh th·ª©c nh∆∞ d∆∞·ªõi üëá

| ID | Gi√° Mua 1 | S·ªë L∆∞·ª£ng Mua 1 | Gi√° Mua 2 | S·ªë L∆∞·ª£ng Mua 2 | Gi√° B√°n 1 | S·ªë L∆∞·ª£ng B√°n 1 | Gi√° B√°n 2 | S·ªë L∆∞·ª£ng B√°n 2 | Gi√° Kh·ªõp | S·ªë L∆∞·ª£ng Kh·ªõp |
|----|-----------|----------------|-----------|----------------|-----------|----------------|-----------|----------------|----------|---------------|
|    |           |                |           |                |           |                |           |                |          |               |
|    |           |                |           |                |           |                |           |                |          |               |


Trong c·ªôt Gi√° mua : s·∫Ω l∆∞u t·ªïng kh·ªëi l∆∞·ª£ng c·ªßa 2 gi√° mua t·ªët nh·∫•t.

Trong c·ªôt Gi√° b√°n : s·∫Ω l∆∞u t·ªïng kh·ªëi l∆∞·ª£ng c·ªßa 2 gi√° b√°n t·ªët nh·∫•t.

Trong 2 c·ªôt kh·ªõp l·ªánh : th·ªÉ hi·ªán gi√° kh·ªõp, s·ªë l∆∞·ª£ng kh·ªõp t·ª´ giao d·ªãch m·ªõi nh·∫•t.

> Trong ƒë·ªÅ t√†i c·ªßa m√¨nh th√¨ m√¨nh c√≥ c√°c c·ªôt gi√° mua | b√°n 3 n·ªØa nh∆∞ng ch·ªâ c·∫ßn nh∆∞ tr√™n l√† c√°c b·∫°n c≈©ng n·∫Øm √Ω t∆∞·ªüng r·ªìi ü§ü

ƒê·∫øn ƒë√¢y th√¨ coi nh∆∞ xong ƒë·ªÅ t√†i 3 lu√¥n r·ªìi !

# [**Post Script**](#post-script)

N·∫øu c√°c b·∫°n th·∫•y b√†i vi·∫øt n√†y h·ªØu √≠ch. ƒê·ª´ng ng·∫ßn ng·∫°i t·∫∑ng m·ªôt ‚≠ê cho m√¨nh nha !

# [**Timeline**](#timeline)

## [**07-03-2022**](#07-03-2022)

- T√¨m hi·ªÉu Cursor 

- Hi·ªÉu v√† ho√†n thi·ªán Stored Procedure kh·ªõp l·ªánh li√™n t·ª•c

## [**08-03-2022**](#08-03-2022)

- T√¨m hi·ªÉu Trigger

- Th√™m b·∫£ng gi√° tr·ª±c tuy·∫øn

- Vi·∫øt Trigger ·ªü b·∫£ng l·ªánh ƒë·∫∑t v√† l·ªánh kh·ªõp ƒë·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu cho b·∫£ng tr·ª±c tuy·∫øn

## [**09-03-2022**](#09-03-2022)

- T√¨m hi·ªÉu SQL Dependency

- T√¨m hi·ªÉu d·ªãch v·ª• SQL Broker

- Ho√†n thi·ªán ƒë·ªì √°n k·∫øt h·ª£p c·∫£ ƒë·ªÅ 2 & 3

# [**Made with üíò and PHP <img src="https://www.vectorlogo.zone/logos/php/php-horizontal.svg" width="60">**](#made-with-love-and-php)